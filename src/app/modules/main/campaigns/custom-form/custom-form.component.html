<div class="container">
  
  <div class="mt-4 font-style d-flex align-items-center">
    <img src="../../../../../assets/images/shield.svg"/>
    <span *ngIf="this.uploadedImage !== ''" class="choose-temp-txt">Fill the details</span>
    <span *ngIf="this.uploadedImage === ''" class="choose-temp-txt">Please upload a template  of your choice</span>
  </div>

  <div *ngIf="this.uploadedImage === ''" class="d-flex justify-content-center align-items-center upload-img-container">
    <div>
      <img src="../../../../../assets/images/upload_image.png" (click)="uploadimg.click()"/>
    
      <div class="text-center mt-4">Please make sure image is less than 2 mb.</div>
      <div class="text-center mt-2">Please make sure image is less than 300 x 300</div>
      <div class="d-flex justify-content-center mt-4">
        <form class="font-style" [formGroup]="templateForm">
          <input
            hidden
            type="file"
            accept="image/*"
            (change)="onChange($event)"
            #uploadimg
          />
        </form>
        <button (click)="uploadimg.click()" class="upload-btn">Upload Template</button>
      </div>
      <mat-error class="d-flex justify-content-center mt-2" *ngIf="this.changeTrigger && this.uploadedImage === ''">Image size should be less than 2mb</mat-error>
    </div>
  </div>

  <div *ngIf="this.uploadedImage !== ''" class="custom-temp-form row">
    <div class="temp-img col-lg-6 col-md-12 mt-4 mb-4">
      <img
        [src]="this.uploadedImage"
        width="100%"
        height="550px"
        class="rounded"
      />
      <div class="mt-3 mb-2 upload-text font-style">Update Template</div>
      <form class="font-style" [formGroup]="templateForm">
        <input
          type="file"
          accept="image/*"
          class="form-control"
          (change)="onChange($event)"
        />
      </form>
    </div>
    <div class="temp-form col-lg-6 col-md-12 mt-4 mb-4">
      <mat-card
        [ngClass]="{ 'h-100': !isScreenSizeMd() }"
        class="mat-card mb-4 rounded"
      >
        <form class="font-style mb-4" [formGroup]="templateForm">
          <div class="row">
            <mat-form-field
              class="w-100 pb-3"
              appearance="outline"
            >
              <mat-label class="label-text">Name Of Campaign</mat-label>
              <input
                class="input-text"
                type="text"
                formControlName="name"
                maxlength="25"
                matInput
              />
              <mat-error
              class="input-error-top-margin"
              *ngIf="
                this.templateForm.controls['name'].errors != null &&
                this.templateForm.controls['name']['errors']['isInvalid']
              "
              >{{ this.templateForm.controls['name']['errors']['message']}}</mat-error
            >
            <mat-hint class="input-error-top-margin" align="end" >{{templateForm.value.name.length || 0}}/25</mat-hint>
            </mat-form-field>

            <mat-form-field
              class="w-100 pb-3"
              appearance="outline"
            >
              <mat-label class="label-text">Email's Subject</mat-label>
              <input
                class="input-text"
                type="text"
                formControlName="subject"
                matInput
                maxlength="70"
              />
              <mat-error
              class="input-error-top-margin"
              *ngIf="
                this.templateForm.controls['subject'].errors != null &&
                this.templateForm.controls['subject']['errors']['isInvalid']
              "
              >{{ this.templateForm.controls['subject']['errors']['message']}}</mat-error
            >
            <mat-hint class="input-error-top-margin" align="end" >{{templateForm.value.subject.length || 0}}/70</mat-hint>
            </mat-form-field>
          </div>

          <div class="mb-3">
            <span class="radio-title">Add Description : </span>
            <mat-radio-group formControlName="addDescription" (change)="onChangeAddDescription($event)">
              <mat-radio-button class="radio-text" [value]="false"
                >No&emsp;</mat-radio-button
              >
              <mat-radio-button class="radio-text" [value]="true"
                >Yes</mat-radio-button
              >
            </mat-radio-group>
          </div>

          <mat-form-field
            *ngIf="isAddDescriptionTrue()"
            class="w-100 pb-4"
            appearance="outline"
          >
            <mat-label class="label-text">Description</mat-label>
            <textarea
              class="input-text"
              type="text"
              formControlName="description"
              matInput
              maxlength="1500"
            ></textarea>
            <mat-error
              class="textarea-error-top-margin"
              *ngIf="
                this.templateForm.controls['description'].errors != null &&
                this.templateForm.controls['description']['errors']['isInvalid']
              "
              >{{ this.templateForm.controls['description']['errors']['message']}}</mat-error
            >
            <mat-hint class="textarea-error-top-margin" align="end" >{{templateForm.value.description.length || 0}}/1500</mat-hint>
          </mat-form-field>

          <mat-form-field
            *ngIf="isAddDescriptionTrue()"
            class="w-100 pb-4"
            appearance="outline"
          >
            <mat-label class="label-text">Add Note</mat-label>
            <textarea
              class="input-text"
              type="text"
              formControlName="note"
              matInput
              maxlength="200"
            ></textarea>
            <mat-hint class="textarea-error-top-margin" align="end" >{{templateForm.value.note.length || 0}}/200</mat-hint>
            <mat-error
              class="textarea-error-top-margin"
              *ngIf="
                this.templateForm.controls['note'].errors != null &&
                this.templateForm.controls['note']['errors']['isInvalid']
              "
              >{{ this.templateForm.controls['note']['errors']['message']}}</mat-error
            >
          </mat-form-field>

          <mat-form-field class="w-100 pb-3" appearance="outline">
            <mat-label class="label-text">Email Signature</mat-label>
            <input
              class="input-text"
              type="text"
              formControlName="emailSignature"
              matInput
              maxlength="40"
            />
            <mat-error
              class="input-error-top-margin"
              *ngIf="
                this.templateForm.controls['emailSignature'].errors != null &&
                this.templateForm.controls['emailSignature']['errors']['isInvalid']
              "
              >{{ this.templateForm.controls['emailSignature']['errors']['message']}}</mat-error
            >
            <mat-hint class="input-error-top-margin" align = "end">{{templateForm.value.emailSignature.length || 0}}/40</mat-hint>
          </mat-form-field>

          <div
            class="col-lg-12 col-md-12 col-sm-12 col-12"
            *ngFor="let mailId = index; let questionCtrl; of: getcontrols()"
            formArrayName="allEmails"
          >
            <div class="row" [formGroupName]="mailId">
              <mat-form-field
                appearance="outline"
                class="col-xl-11 col-lg-10 col-md-10 col-sm-10 col-10 pb-3"
              >
                <mat-label>Email for simulation</mat-label>
                <input matInput type="text" formControlName="senderEmail" />
                <mat-error
                  class="input-error-top-margin"
                  *ngIf="isEmailFieldInvalid(mailId)"
                  >{{ emailFieldErrorMessage(mailId)}}</mat-error>
              </mat-form-field>
              <div class="col-xl-1 col-lg-2 col-md-2 col-sm-2 col-2 p-1">
                <button
                  type="button"
                  class="buttons w-75 h-75 border-0 rounded d-flex align-items-center justify-content-center"
                  (click)="emailFieldOperation(mailId)"
                >
                  <div *ngIf="mailId === 0" class="plus text-white">+</div>
                  <mat-icon *ngIf="mailId > 0" class="cross text-white"
                    >clear</mat-icon
                  >
                </button>
              </div>
            </div>
          </div>

          <div
            [ngClass]="{
              'position-absolute bottom-0 w-100': !isScreenMobile()
            }"
            class="row d-flex justify-content-center mt-4 mb-3"
          >
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12 mb-2">
              <button class="w-100 preview-btn rounded" (click)="checkFormData('Preview')">Preview</button>
            </div>
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12 mb-2">
              <button
                (click)="checkFormData('Schedule')"
                class="w-100 schedule-btn rounded"
              >
                Schedule Campaign
              </button>
            </div>
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12">
              <button (click)="checkFormData('Send')" class="w-100 send-btn rounded">
                Send Campaign
              </button>
            </div>
          </div>
        </form>
      </mat-card>
    </div>
  </div>
</div>
